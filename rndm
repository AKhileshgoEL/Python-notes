import pandas as pd

# Create a DataFrame with sample data
data = {'id': [1, 2, 3],
        'name': ['John Doe', 'Jane Smith', 'Bob Johnson'],
        'age': [25, 30, 22]}

df = pd.DataFrame(data)

# Print the DataFrame
print("Original DataFrame:")
print(df)

# Save the DataFrame to a CSV file
csv_file_path = 'output_pandas.csv'
df.to_csv(csv_file_path, index=False)

print(f'Data exported to {csv_file_path}')

import pandas as pd

# Sample list of tuples
data = [(1, 'Alice', 25),
        (2, 'Bob', 30),
        (3, 'Charlie', 22)]

# Create a DataFrame from the list of tuples
df = pd.DataFrame(data, columns=['ID', 'Name', 'Age'])

# Select only the first and third elements from each tuple
selected_elements = df.apply(lambda row: (row['ID'], row['Age']), axis=1)

# Create a new DataFrame with the selected elements
selected_df = pd.DataFrame(selected_elements.tolist(), columns=['Selected_ID', 'Selected_Age'])

# Specify the CSV file path
csv_file_path = 'selected_elements.csv'

# Write the new DataFrame to a CSV file
selected_df.to_csv(csv_file_path, index=False)

print(f'Selected elements have been written to {csv_file_path}')









import pandas as pd

# Sample list of tuples
data = [("ac_rfg", "tfgg", 56),
        ["ac_rgy", "tfgg", 67]]

# Create a DataFrame from the list of tuples
df = pd.DataFrame(data, columns=['Tuple1', 'Tuple2', 'Number'])

# Extract specific substrings from Tuple1 and Tuple2
df['Extracted1'] = df['Tuple1'].apply(lambda x: (x[:2], x[3:6], df.loc[df['Tuple1'] == x, 'Number'].values[0]))
df['Extracted2'] = df['Tuple2'].apply(lambda x: (x[:2], x[3:6], df.loc[df['Tuple2'] == x, 'Number'].values[0]))

# Create a new DataFrame with the extracted elements
extracted_df = pd.DataFrame(df[['Extracted1', 'Extracted2']].values.tolist(), columns=['Extracted1', 'Extracted2'])

# Specify the CSV file path
csv_file_path = 'extracted_elements.csv'

# Write the new DataFrame to a CSV file
extracted_df.to_csv(csv_file_path, index=False)

print(f'Extracted elements have been written to {csv_file_path}')





SELECT 
    SUBSTR(code, 1, 3) AS shortened_code,
    CAST(SUBSTR(code, 5, 8) AS INTEGER) AS date_value,
    value
FROM your_table;
